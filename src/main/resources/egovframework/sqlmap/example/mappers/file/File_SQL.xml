<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="egovframework.example.file.service.impl.FileMapper">

	<insert id="insertFile" parameterType="fileVO">
		INSERT INTO SCENARIO
		(
		NAME, URL, CDATE, CTIME)
		VALUES
		( #{name}, #{url},#{cdate}, #{ctime})
	</insert>

	<update id="updateFile">
		UPDATE SAMPLE
		SET ID=#{id}
		, NAME=#{name}
		,
		DESCRIPTION=#{description}
		, USE_YN=#{useYn}
		WHERE ID=#{id}

	</update>

	<delete id="deleteFile">
		UPDATE SITE
		SET DDATE=#{ddate},
		DTIME=#{dtime},
		VERSION
		= VERSION+1
		WHERE seq=#{seq}
	</delete>

	<select id="selectFile" resultType="fileVO">
		SELECT
		ID, NAME, DESCRIPTION,
		USE_YN, REG_USER
		FROM SAMPLE
		WHERE ID=#{id}
	</select>
	
	<select id="selectFileList" parameterType="searchVO"
		resultType="egovMap">
		SELECT
		SEQ, NAME, URL, VERSION, CTIME, CDATE, UTIME,
		UDATE,
		DTIME, DDATE
		FROM SCENARIO
		WHERE DDATE =0 AND DTIME=0
		<if test="searchKeyword != null and searchKeyword != ''">
			<choose>
				<when test="searchCondition == 0">
					AND URL LIKE '%' || #{searchKeyword} || '%'
				</when>
				<when test="searchCondition == 1">
					AND URL LIKE '%' || #{searchKeyword} || '%'
				</when>
			</choose>
		</if>
		<if test="userSeq != null and userSeq != 0">
			<choose>
				<when test="searchCondition == 0">
					AND USER_SEQ = #{userSeq}
				</when>
			</choose>
		</if>
		ORDER BY SEQ ASC
		LIMIT #{recordCountPerPage} OFFSET #{firstIndex}
	</select>
</mapper>