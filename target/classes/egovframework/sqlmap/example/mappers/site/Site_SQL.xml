<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="egovframework.example.site.service.impl.SiteMapper">

	<resultMap id="sample"
		type="egovframework.example.sample.service.SampleVO">
		<result property="id" column="id" />
		<result property="name" column="name" />
		<result property="description" column="description" />
		<result property="useYn" column="use_yn" />
		<result property="regUser" column="reg_user" />
	</resultMap>

	<insert id="insertSite" parameterType="SiteVO">
		INSERT INTO SITE
		( URL
		,
		CDATE
		, CTIME)
		VALUES ( #{url}
		, #{cdate}
		, #{ctime} )
	</insert>

	<update id="updateSite">
		UPDATE SAMPLE
		SET ID=#{id}
		, NAME=#{name}
		,
		DESCRIPTION=#{description}
		, USE_YN=#{useYn}
		WHERE ID=#{id}

	</update>

	<delete id="deleteSite">
		UPDATE SITE
		SET DDATE=#{ddate},
		DTIME=#{dtime}
		WHERE seq=#{seq}
	</delete>

	<select id="selectSite" resultMap="sample">
		SELECT
		ID, NAME, DESCRIPTION,
		USE_YN, REG_USER
		FROM SAMPLE
		WHERE ID=#{id}

	</select>

	<select id="selectSiteList" parameterType="searchVO"
		resultType="egovMap">
		SELECT
		SEQ, USER_SEQ, URL, SCENARIO_ID, VERSION, CTIME, CDATE, UTIME,
		UDATE,
		DTIME, DDATE
		FROM SITE
		WHERE DDATE =0 AND DTIME=0
		<if test="searchKeyword != null and searchKeyword != ''">
			<choose>
				<when test="searchCondition == 0">
					AND URL LIKE '%' || #{searchKeyword} || '%'
				</when>
				<when test="searchCondition == 1">
					AND URL LIKE '%' || #{searchKeyword} || '%'
				</when>
			</choose>
		</if>
		<if test="userSeq != null and userSeq != 0">
			<choose>
				<when test="searchCondition == 0">
					AND USER_SEQ = #{userSeq}
				</when>
			</choose>
		</if>
		ORDER BY SEQ ASC
		LIMIT #{recordCountPerPage} OFFSET #{firstIndex}
	</select>

	<select id="selectSiteListTotCnt" parameterType="searchVO"
		resultType="int">

		SELECT COUNT(*) totcnt
		FROM SITE
		WHERE DDATE =0 AND DTIME =0
		<if test="searchKeyword != null and searchKeyword != ''">
			<choose>
				<when test="searchCondition == 0">
					AND URL LIKE '%' || #{searchKeyword} || '%'
				</when>
				<when test="searchCondition == 1">
					AND URL LIKE '%' || #{searchKeyword} || '%'
				</when>
			</choose>
		</if>
		<if test="userSeq != null and userSeq != 0">
			<choose>
				<when test="searchCondition == 0">
					AND USER_SEQ = #{userSeq}
				</when>
			</choose>
		</if>
	</select>

</mapper>